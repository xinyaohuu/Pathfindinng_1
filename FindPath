from grid import Grid
from dijkstra import dijkstra
from astar import a_star

import csv

# Define the input and output file paths
input_file_path = 'RandomObs.csv'  # Replace with your CSV file path
output_file_path = 'RandomObs_with_paths.csv'  # New CSV file with additional columns

# Read the CSV file and create a list to store rows
rows = []

with open(input_file_path, 'r') as file:
    csv_reader = csv.reader(file)
    header = next(csv_reader, None)  # Skip the header row if it exists

    for row in csv_reader:
        mapsize, percentage, Num_obstacles, obstacles = row
        x, y = map(int, mapsize.split(' * '))
        obs_coords = eval(obstacles)  # Convert string to a list of tuples

        g = Grid(x, y, obstacles=obs_coords)
        src = (0, 0)
        dest = (x-1, y-1)

        nodes = g.get_nodes()
        path1 = dijkstra(g, src, dest)
        path2 = a_star(g, src, dest)

        # Add path1 and path2 to the row
        row.extend([str(path1), str(path2)])

        # Append the modified row to the list of rows
        rows.append(row)

# Write the modified data to a new CSV file
with open(output_file_path, 'w', newline='') as output_file:
    csv_writer = csv.writer(output_file)

    # Write the header
    csv_writer.writerow(header + ['dmethod', 'astar'])

    # Write the rows with path1 and path2 added
    csv_writer.writerows(rows)

print("New CSV file with path1 and path2 columns created:", output_file_path)
